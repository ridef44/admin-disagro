<div class="mx-auto max-w-screen-lg px-4 lg:px-12 mt-2 mb-4">
  <div class="bg-white relative shadow-md sm:rounded-lg overflow-hidden">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-3 md:space-y-0 md:space-x-4 p-4"></div>
    <div class="flex flex-col md:flex-row items-stretch md:items-center md:space-x-3 space-y-3 md:space-y-0 justify-between mx-4 py-4 border-t">
      <!-- Busqueda -->
      <div class="w-full md:w-1/2">
        <form action="/productos" method="GET" class="flex items-center">
          <label for="simple-search" class="sr-only">Search</label>
          <div class="relative w-80">
            <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"></div>
            <input type="text" name="search" value="{{searchTerm}}" placeholder="Buscar Productos" required="" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full pl-10 p-2">
          </div>
          <!-- Botón con tooltip -->
          <div class="relative group mx-2">
            <button type="submit" class="bg-slate-800 hover:bg-stone-700 hover:text-red-500 text-white font-bold py-2 px-4 rounded-md">
              <i data-feather="search"></i>
            </button>
            <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-800 text-white text-xs rounded py-1 px-2 transition-opacity duration-300 opacity-0 group-hover:opacity-100">
              Buscar
            </div>
          </div>
          <!-- Enlace con tooltip -->
          <div class="relative group mx-2 mt-1">
            <a href="/productos" class="bg-slate-800 hover:bg-stone-700 hover:text-red-500 text-white font-bold py-2 px-4 rounded-md inline-block">
              <i class="" data-feather="rotate-cw"></i>
            </a>
            <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-800 text-white text-xs rounded py-1 px-2 transition-opacity duration-300 opacity-0 group-hover:opacity-100">
              Limpiar
            </div>
          </div>
        </form>
      </div>
      <!-- Busqueda -->
      <div class="w-full md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0">
        <a href="/add-productos" class="flex items-center justify-center font-medium rounded-lg text-sm px-3 py-2 text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-teal-300">
          <i class="mr-2" data-feather="plus"></i>
          Agregar Producto
        </a>
      </div>
    </div>
    <!--Tabla Principal-->
    <div id="formMain" class="overflow-x-auto">
      <table class="w-full text-sm text-left text-gray-600">
        <thead class="text-xs text-gray-800 uppercase bg-gray-100">
          <tr>
            <th class="px-4 py-2">Codigo</th>
            <th class="px-4 py-2">Descripcion</th>
            <th class="px-4 py-2">Precio</th>
            <th class="px-4 py-2">Tipo</th>
            <th class="px-4 py-2">Acciones</th>
          </tr>
        </thead>
        <tbody>
          {{#each producto}}
          <tr class="hover:bg-gray-100 hover:text-gray-900">
            <td class="px-4 py-2">{{this.id}}</td>
            <td scope="row" class="px-4 py-3 font-medium whitespace-nowrap ">
              <div class="flex items-center mr-3">
                {{this.name}}
              </div>
            </td>
            <td scope="row" class="px-4 py-3 font-medium whitespace-nowrap uppercase">
              <div class="flex items-center mr-3">
                Q.
                {{this.price}}
              </div>
            </td>
            <td class="px-4 py-3 font-normal whitespace-nowrap ">
              <div class="flex items-center">
                {{this.type}}
              </div>
            </td>
            <!--Botones de Acciones -->
            <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap">
              <div class="flex items-center space-x-4">
                <!-- Botón de cambio de contraseña -->
                <div class="relative group">
                  <a href="/read/{{this.id}}" class="py-2 px-3 flex items-center text-sm font-medium text-center text-amber-500 bg-white rounded-lg border border-amber-500 hover:text-white hover:bg-amber-500 focus:ring-4 focus:outline-none focus:ring-amber-300 botones">
                    <i class="" data-feather="eye"></i>
                  </a>
                  <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-800 text-white text-xs rounded py-1 px-2 transition-opacity duration-300 opacity-0 group-hover:opacity-100">
                    Ver producto
                  </div>
                </div>

                <!-- Botón de edición -->
                <div class="relative group">
                  <a href="/edit/{{this.id}}"
                   class="py-2 px-3 flex items-center text-sm font-medium text-center text-sky-500 bg-white rounded-lg border border-sky-500 hover:text-white hover:bg-sky-500 focus:ring-4 focus:outline-none focus:ring-sky-300 botones">
                    <i class="" data-feather="edit"></i>
                  </a>
                  <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-800 text-white text-xs rounded py-1 px-2 transition-opacity duration-300 opacity-0 group-hover:opacity-100">
                    Editar producto
                  </div>
                </div>

                <!-- Botón de eliminación -->
                <div class="relative group">
                  <button onclick="openModal({{this.id}})" type="button" class="py-2 px-3 flex items-center text-sm font-medium text-center text-red-700 bg-white rounded-lg border border-red-700 hover:text-white hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 botones">
                    <i class="" data-feather="trash-2"></i>
                  </button>
                  <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-800 text-white text-xs rounded py-1 px-2 transition-opacity duration-300 opacity-0 group-hover:opacity-100">
                    Eliminar producto
                  </div>
                </div>
              </div>
            </td>
            <!--Botones de Acciones -->
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </div>
</div>


<div class="fixed hidden flex items-center justify-between z-10 bottom-0 right-0 mb-4 mr-4 py-3 px-6 text-rose -500 bg-white rounded-lg shadow dark:text-gray-400 dark:bg-gray-800" id="notificacion">
    <div class="mr-4 inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-red-500 bg-red-100 rounded-lg dark:bg-red-800 dark:text-red-200">
        <i data-feather="package"></i>
       
    </div>
    <div class="flex flex-col ml-3">
        <b class="text-sm font-bold text-black dark:text-white">¡Borrado!</b>
        <div class="text-sm font-normal">El producto fue eliminado.</div>
    </div>
    <button onclick="this.parentElement.style.display='none'" class="text-xl font-bold leading-none outline-none focus:outline-none ml-4" >
        ×
    </button>
</div>

<!-- Modal de Confirmación -->
<div id="modal" class="fixed inset-0 bg-gray-500 bg-opacity-75 hidden overflow-y-auto h-screen w-full flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-5 max-w-lg w-full">
    <h2 class="text-lg font-bold text-center text-gray-900">Confirmar Eliminación</h2>
    <p class="text-gray-600 my-4">¿Estás seguro de que deseas eliminar este usuario? Esta acción no se puede deshacer.</p>
    <form id="deleteForm" action="" method="POST" class="text-center">
      <input type="hidden" name="userId" id="userId" value="">
      <button type="button" onclick="confirmDelete()" class="bg-rose-500 hover:bg-rose-700 text-white font-bold py-2 px-4 rounded mr-2">
        Eliminar
      </button>
      <button type="button" onclick="closeModal()" class="bg-gray-300 hover:bg-gray-500 hover:text-white text-gray-800 font-bold py-2 px-4 rounded">
        Cancelar
      </button>
    </form>
  </div>
</div>

<script>
function openModal(userId) {
  document.getElementById('userId').value = userId; // Configura el ID del usuario en el formulario
  document.getElementById('modal').classList.remove('hidden'); // Muestra el modal
  document.getElementById('deleteForm').action = `/delete/${userId}`; // Configura la acción del formulario
}

function closeModal() {
  document.getElementById('modal').classList.add('hidden'); // Oculta el modal
}

function confirmDelete() {
  const form = document.getElementById('deleteForm');
  form.submit(); // Envía el formulario
  closeModal(); // Cierra el modal inmediatamente después de enviar el formulario
  showNotification(); // Muestra la notificación de éxito
}

function showNotification() {
  const notification = document.getElementById('notificacion');
  const botones = document.querySelectorAll('.botones');
  const form1 = document.getElementById('formMain');
    
    notification.classList.remove('hidden');
    botones.forEach(boton => {
        boton.classList.add('pointer-events-none');
    });
  
  
  setTimeout(() => {
    closeNotification(); // Oculta la notificación después de 3 segundos
  }, 3000);
}

function closeNotification() {
    const notification = document.getElementById('notificacion');
    const botones = document.querySelectorAll('.botones');
    const form1 = document.getElementById('formMain');

    notification.classList.add('hidden');
    botones.forEach(boton => {
        boton.classList.remove('pointer-events-none');
    });
}
</script>